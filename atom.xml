<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lucia’s note</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2017-01-16T05:58:18.865Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Lucia.M</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>搭建hexo主题博客</title>
    <link href="http://yoursite.com/2017/01/16/%E6%90%AD%E5%BB%BAhexo%E4%B8%BB%E9%A2%98%E5%8D%9A%E5%AE%A2/"/>
    <id>http://yoursite.com/2017/01/16/搭建hexo主题博客/</id>
    <published>2017-01-16T05:56:33.000Z</published>
    <updated>2017-01-16T05:58:18.865Z</updated>
    
    <content type="html"><![CDATA[<p>[toc]</p>
<h1 id="简要"><a href="#简要" class="headerlink" title="简要"></a>简要</h1><p><strong>相关说明</strong></p>
<ul>
<li>Github Pages 实现静态网页部署</li>
<li>Hexo主题美化博客</li>
</ul>
<p><strong>实现目标</strong></p>
<ul>
<li>博客生成</li>
<li>域名绑定</li>
<li>双线路</li>
<li>博客备份</li>
</ul>
<p><strong>准备工作</strong>  </p>
<ul>
<li><a href="https://git-for-windows.github.io/" target="_blank" rel="external">安装msysgit</a></li>
<li><a href="https://nodejs.org/en/download/" target="_blank" rel="external">安装Node.js</a></li>
</ul>
<h1 id="搭建"><a href="#搭建" class="headerlink" title="搭建"></a>搭建</h1><ul>
<li>命令行操作均在Git Bash下进行</li>
</ul>
<h2 id="Hexo"><a href="#Hexo" class="headerlink" title="Hexo"></a>Hexo</h2><h3 id="安装-Hexo"><a href="#安装-Hexo" class="headerlink" title="安装 Hexo"></a>安装 Hexo</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ # 更换 taobao的npm源</div><div class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</div><div class="line">$ # 安装 hexo</div><div class="line">$ npm install hexo-cli -g</div><div class="line">$ npm install hexo --save</div></pre></td></tr></table></figure>
<h3 id="初始化-Hexo"><a href="#初始化-Hexo" class="headerlink" title="初始化 Hexo"></a>初始化 Hexo</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ # 新建 Hexo文件夹</div><div class="line">$ mkdir X:/yourfile/Hexo</div><div class="line">$ # 初始化</div><div class="line">$ hexo init</div><div class="line">$ npm install</div></pre></td></tr></table></figure>
<h3 id="安装-Hexo插件"><a href="#安装-Hexo插件" class="headerlink" title="安装 Hexo插件"></a>安装 Hexo插件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">npm install hexo-generator-index --save</div><div class="line">npm install hexo-generator-archive --save</div><div class="line">npm install hexo-generator-category --save</div><div class="line">npm install hexo-generator-tag --save</div><div class="line">npm install hexo-server --save</div><div class="line">npm install hexo-deployer-git --save</div><div class="line">npm install hexo-deployer-heroku --save</div><div class="line">npm install hexo-deployer-rsync --save</div><div class="line">npm install hexo-deployer-openshift --save</div><div class="line">npm install hexo-renderer-marked@0.2 --save</div><div class="line">npm install hexo-renderer-stylus@0.2 --save</div><div class="line">npm install hexo-generator-feed@1 --save</div><div class="line">npm install hexo-generator-sitemap@1 --save</div></pre></td></tr></table></figure>
<h3 id="查看Hexo-本地效果"><a href="#查看Hexo-本地效果" class="headerlink" title="查看Hexo 本地效果"></a>查看Hexo 本地效果</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hexo generate || hexo g</div><div class="line">hexo server   || hexo s</div></pre></td></tr></table></figure>
<p><strong>效果url：localhost:4000</strong></p>
<hr>
<h2 id="博客部署Github-Pages"><a href="#博客部署Github-Pages" class="headerlink" title="博客部署Github Pages"></a>博客部署Github Pages</h2><h3 id="配置Github"><a href="#配置Github" class="headerlink" title="配置Github"></a>配置Github</h3><ul>
<li>注册<a href="https://github.com/" target="_blank" rel="external">Github</a>账户（Sign Up）</li>
<li>创建项目仓库<a href="https://github.com/new" target="_blank" rel="external">New repository</a></li>
<li>仓库名称必须为 username.github.io</li>
<li>初始化仓库</li>
</ul>
<h3 id="配置SSH密钥"><a href="#配置SSH密钥" class="headerlink" title="配置SSH密钥"></a>配置SSH密钥</h3><ul>
<li>实现本地代码库通过git操作与远端Github代码库同步</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ -d ~/.ssh ] &amp;&amp; clip &lt; ~/.ssh/id_rsa.pub^C| ssh-keygen -t rsa -C &quot;your_email@example.com&quot;</div></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>存在SSH密钥则将公钥的内容复制到系统粘贴板(clipboard)，否则创建密钥</li>
<li>创建密钥过程中，提示输密码直接回车</li>
<li>登录Github → Account Setting → SSH keys and GPG keys → Add SSH key</li>
</ul>
</blockquote>
<ul>
<li>测试设置成功与否</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh -T git@github.com</div></pre></td></tr></table></figure>
<ul>
<li>用户信息设置<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git config --global user.name &quot;XXXX&quot;</div><div class="line">$ git config --global user.email  &quot;XXXX@gmail.com&quot;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Hexo-更新到Github-仓库"><a href="#Hexo-更新到Github-仓库" class="headerlink" title="Hexo 更新到Github 仓库"></a>Hexo 更新到Github 仓库</h2><ul>
<li>配置项 <strong>_config.yml</strong> (X:\yourfile\Hexo)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># Deployment</div><div class="line">## Docs: https://hexo.io/docs/deployment.html</div><div class="line">deploy:</div><div class="line">  type: git</div><div class="line">  repository: git@github.com:xxxx/xxxx.github.io.git</div><div class="line">  branch: master</div></pre></td></tr></table></figure>
<ul>
<li><p>执行命令进行部署</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo g -d</div></pre></td></tr></table></figure>
</li>
<li><p>xxxx.github.io 进行访问即可</p>
</li>
</ul>
<h1 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h1><h2 id="Hexo-相关"><a href="#Hexo-相关" class="headerlink" title="Hexo 相关"></a>Hexo 相关</h2><h3 id="更换主题"><a href="#更换主题" class="headerlink" title="更换主题"></a>更换主题</h3><ul>
<li><a href="https://hexo.io/themes/" target="_blank" rel="external">Hexo 官网主题</a></li>
<li>本博客使用的是 yilia 主题</li>
</ul>
<ol>
<li>安装 （X:\yourfile\Hexo\themes 下）</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone https://github.com/litten/hexo-theme-yilia.git themes/yilia</div></pre></td></tr></table></figure>
<ol>
<li>配置</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 修改hexo根目录下的 _config.yml</div><div class="line">_config.yml ： theme: yilia</div></pre></td></tr></table></figure>
<ol>
<li>更新<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd themes/yilia</div><div class="line">git pull</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="Hexo-命令"><a href="#Hexo-命令" class="headerlink" title="Hexo 命令"></a>Hexo 命令</h3><h2 id="域名"><a href="#域名" class="headerlink" title="域名"></a>域名</h2><h3 id="关联域名（简单粗暴）"><a href="#关联域名（简单粗暴）" class="headerlink" title="关联域名（简单粗暴）"></a>关联域名（简单粗暴）</h3><ul>
<li>\hexo\source 文件夹下创建文件 CNAME 并提交</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">echo www.xxxx.xxx &gt; CNAME</div><div class="line">hexo g -d</div></pre></td></tr></table></figure>
<ul>
<li>添加记录</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">CNAME WWW xxxx.github.io</div></pre></td></tr></table></figure>
<p>注意:这个简单粗暴指的是操作简单，但是有些浏览器无法解析。比如谷歌和火狐能顺利打开网页，但是360浏览器表示有点方，一直404</p>
<h3 id="关联域名-（DNSPOD）"><a href="#关联域名-（DNSPOD）" class="headerlink" title="关联域名 （DNSPOD）"></a>关联域名 （DNSPOD）</h3><ul>
<li>\hexo\source 文件夹下创建文件 CNAME 并提交</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">echo xxxx.xxx &gt; CNAME</div><div class="line">hexo g -d</div></pre></td></tr></table></figure>
<ul>
<li><p>修改域名提供商提供的DNS</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">f1g1ns2.dnspod.net </div><div class="line">f1g1ns1.dnspod.net</div></pre></td></tr></table></figure>
</li>
<li><p>使用<a href="https://www.dnspod.cn/" target="_blank" rel="external">DNSPOD</a> 账户添加域名解析</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">www    A    默认    IP Address</div><div class="line">@      A    默认    IP Address</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Lucia’note"><a href="#Lucia’note" class="headerlink" title="Lucia’note"></a>Lucia’note</h2><ul>
<li>博客搭建在github与gitcafe上，域名解析哪个快走哪个</li>
<li>博客备份在git@osc </li>
</ul>
<h3 id="博客备份"><a href="#博客备份" class="headerlink" title="博客备份"></a>博客备份</h3><ol>
<li>删除文件夹内原有的.git缓存文件(以防造成仓库冲突)</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ -d .git ] &amp;&amp; rm .git</div></pre></td></tr></table></figure>
<ol>
<li><p>编辑.gitignore(指定忽略文件）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">/.deploy_git        #hexo默认的.git配置文件夹</div><div class="line">/public             #根据source文件夹内容自动生成</div><div class="line">/_config.yml        #配置文件含重要信息</div></pre></td></tr></table></figure>
</li>
<li><p>初始化仓库并添加远程仓库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git init</div><div class="line">git remote add origin &lt;server&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>添加本地文件提交说明到仓库并同步到远端仓库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git add .  </div><div class="line">git commit -m &quot;first commit&quot; </div><div class="line">git push -u origin master</div></pre></td></tr></table></figure>
</li>
<li><p>更新同步操作</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git add .</div><div class="line">git commit -m &apos;更新信息&apos;</div><div class="line">git push</div></pre></td></tr></table></figure>
<ol>
<li>拉取备份文件</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">git init</div><div class="line">git remote add origin &lt;server&gt; </div><div class="line">git fetch --all</div><div class="line">git reset --hard origin/master</div><div class="line"># 更新后拉取</div><div class="line">git pull</div></pre></td></tr></table></figure>
<p><strong>博客搭建成功—致谢以下道友的辛苦探路</strong></p>
<blockquote>
<p><a href="https://my.oschina.net/ryaneLee/blog/638440" target="_blank" rel="external">https://my.oschina.net/ryaneLee/blog/638440</a><br><a href="https://segmentfault.com/a/1190000003710980" target="_blank" rel="external">https://segmentfault.com/a/1190000003710980</a><br><a href="https://segmentfault.com/a/1190000003710962" target="_blank" rel="external">https://segmentfault.com/a/1190000003710962</a><br><a href="https://segmentfault.com/a/1190000003710962" target="_blank" rel="external">https://segmentfault.com/a/1190000003710962</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;[toc]&lt;/p&gt;
&lt;h1 id=&quot;简要&quot;&gt;&lt;a href=&quot;#简要&quot; class=&quot;headerlink&quot; title=&quot;简要&quot;&gt;&lt;/a&gt;简要&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;相关说明&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Github Pages 实现静态网页部署&lt;
    
    </summary>
    
    
      <category term="hexo" scheme="http://yoursite.com/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>mysql5.6.zip 安装</title>
    <link href="http://yoursite.com/2016/12/05/mysql/"/>
    <id>http://yoursite.com/2016/12/05/mysql/</id>
    <published>2016-12-05T12:52:31.000Z</published>
    <updated>2016-12-05T13:35:37.201Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p>
<h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><hr>
<p> mysql5.6</p>
<blockquote>
<ul>
<li>下载地址 <a href="http://dev.mysql.com/downloads/mysql/5.6.html" target="_blank" rel="external">http://dev.mysql.com/downloads/mysql/5.6.html</a> </li>
</ul>
</blockquote>
<h1 id="安装过程"><a href="#安装过程" class="headerlink" title="安装过程"></a>安装过程</h1><p>解压缩重命名</p>
<blockquote>
<ul>
<li>解压缩在C盘某个文件夹下并重命名为MySQL SERVER 5.6(便于记忆)</li>
<li>mysql-5.6.34-winx64 →  MySQL SERVER 5.6(或mysql56) </li>
</ul>
</blockquote>
<p>设置环境变量</p>
<blockquote>
<ul>
<li>此电脑→高级系统设置→高级→环境变量→PATH→编辑→编辑文本<br>追加 ;C:\Program Files (x86)\MySQL\MySQL Server 5.6\bin\;</li>
</ul>
</blockquote>
<p>修改配置文件</p>
<blockquote>
<ul>
<li>配置文件：MySQL Server 5.6\my-default.ini 添加配置如代码框中所示<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"># For advice on how to change settings please see</div><div class="line"># http://dev.mysql.com/doc/refman/5.6/en/server-configuration-defaults.html</div><div class="line"># *** DO NOT EDIT THIS FILE. It&apos;s a template which will be copied to the</div><div class="line"># *** default location during install, and will be replaced if you</div><div class="line"># *** upgrade to a newer version of MySQL.</div><div class="line"></div><div class="line">[mysqld]</div><div class="line"></div><div class="line"># Remove leading # and set to the amount of RAM for the most important data</div><div class="line"># cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.</div><div class="line"># innodb_buffer_pool_size = 128M</div><div class="line"></div><div class="line"># Remove leading # to turn on a very important data integrity option: logging</div><div class="line"># changes to the binary log between backups.</div><div class="line"># log_bin</div><div class="line"></div><div class="line"># These are commonly set, remove the # and set as required.</div><div class="line"># basedir = .....</div><div class="line"># datadir = .....</div><div class="line"># port = .....</div><div class="line"># server_id = .....</div><div class="line"></div><div class="line">#--- 添加配置如下 ---#</div><div class="line"># mysql所在目录</div><div class="line">basedir = C:\Program Files (x86)\MySQL\MySQL Server 5.6</div><div class="line"># mysql所在目录\data</div><div class="line">datadir = C:\Program Files (x86)\MySQL\MySQL Server 5.6\data</div><div class="line"></div><div class="line"></div><div class="line"># Remove leading # to set options mainly useful for reporting servers.</div><div class="line"># The server defaults are faster for transactions and fast SELECTs.</div><div class="line"># Adjust sizes as needed, experiment to find the optimal values.</div><div class="line"># join_buffer_size = 128M</div><div class="line"># sort_buffer_size = 2M</div><div class="line"># read_rnd_buffer_size = 2M </div><div class="line"></div><div class="line">sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES</div></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>
<p>以管理员身份运行cmd（否则会因权限不够报错 Install/Remove of the Service Denied!）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">C:\Users\lucia\Desktop&gt;cd C:\Program Files (x86)\MySQL\MySQL Server 5.6\bin\</div><div class="line"></div><div class="line">C:\Program Files (x86)\MySQL\MySQL Server 5.6\bin&gt;mysql -install</div></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>必须进入bin文件夹，否则启动服务会报错 发生系统错误 2</li>
</ul>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;准备工作&quot;&gt;&lt;a href=&quot;#准备工作&quot; class=&quot;headerlink&quot; title=&quot;准备工作&quot;&gt;&lt;/a&gt;准备工作&lt;/h1&gt;&lt;hr&gt;
&lt;p&gt; mysql5.6&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;下载地址 &lt;a 
    
    </summary>
    
    
      <category term="mysql" scheme="http://yoursite.com/tags/mysql/"/>
    
      <category term="windows10" scheme="http://yoursite.com/tags/windows10/"/>
    
  </entry>
  
  <entry>
    <title>git</title>
    <link href="http://yoursite.com/2016/12/03/git/"/>
    <id>http://yoursite.com/2016/12/03/git/</id>
    <published>2016-12-03T07:25:14.000Z</published>
    <updated>2016-12-03T08:03:53.798Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Linux源代码安装Git及其他附录</title>
    <link href="http://yoursite.com/2016/11/24/sourcecodeGIT/"/>
    <id>http://yoursite.com/2016/11/24/sourcecodeGIT/</id>
    <published>2016-11-24T02:01:08.000Z</published>
    <updated>2016-12-03T08:03:08.703Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p>
<h1 id="环境说明："><a href="#环境说明：" class="headerlink" title="环境说明："></a>环境说明：</h1><blockquote>
<ul>
<li>OS：CentOS-6.5.mininal  (NULL)</li>
<li>GIT：git version 2.8.2 <figure class="highlight plain"><figcaption><span>NULL特指什么软件都未安装（纯净版）</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[2] OS 新建了一个用户 xiaolu</div></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>
<h1 id="准备工作："><a href="#准备工作：" class="headerlink" title="准备工作："></a>准备工作：</h1><h2 id="安装-EPEL源"><a href="#安装-EPEL源" class="headerlink" title="安装 EPEL源"></a>安装 EPEL源</h2><p>根据CentOS的版本下载不同的镜像   (  使用的是国内的EPEL源-科大源）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[root@lucia ~]# su xiaolu</div><div class="line">[xiaolu@lucia root]$ cd /etc/yum.repos.d/</div><div class="line">[xiaolu@lucia yum.repos.d]$ sudo yum -y install wget</div><div class="line">[xiaolu@lucia yum.repos.d]$ sudo mv CentOS-Base.repo CentOS-Base.repo.bak</div><div class="line">[xiaolu@lucia yum.repos.d]$ sudo wget -O CentOS-Base.repo https://lug.ustc.edu.cn/wiki/_export/code/mirrors/help/centos?codeblock=2  </div><div class="line">                            # wget -O  --output-document=FILE  指定下载目录和文件名</div><div class="line">[xiaolu@lucia yum.repos.d]$ yum makecache</div><div class="line">#附-科大源：https://lug.ustc.edu.cn/wiki/mirrors/help/centos</div></pre></td></tr></table></figure></p>
<h2 id="时间校准"><a href="#时间校准" class="headerlink" title="时间校准"></a>时间校准</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[xiaolu@lucia yum.repos.d]$ cd /tmp</div><div class="line">[xiaolu@lucia tmp]$ sudo yum -y install ntpdate.x86_64</div><div class="line">[xiaolu@lucia tmp]$ sudo ntpdate 0.pool.ntp.org</div><div class="line"> 1 Apr 16:40:49 ntpdate[7329]: no server suitable for synchronization found</div><div class="line">---------------------------------------------------------------------------------</div><div class="line">[xiaolu@lucia tmp]$ sudo yum -y install rdate.x86_64</div><div class="line">[xiaolu@lucia tmp]$ sudo rdate -s time.nist.gov</div><div class="line">[xiaolu@lucia tmp]$ date</div><div class="line">Sun May  1 23:17:19 CST 2016</div></pre></td></tr></table></figure>
<p> 注：ntpdate校准报错选择rdate（很可能是防火墙封锁了udp的123端口, 如果关闭的防火墙问题依旧, 很可能是上层路由的设置有问题, 如果这种情况, 我们就只能通过tcp来更新时间）</p>
<h1 id="安装Git（-源代码安装）"><a href="#安装Git（-源代码安装）" class="headerlink" title="安装Git（ 源代码安装）"></a>安装Git（ 源代码安装）</h1><h2 id="Step-1-安装所需的依赖包"><a href="#Step-1-安装所需的依赖包" class="headerlink" title="Step 1: 安装所需的依赖包"></a>Step 1: 安装所需的依赖包</h2><p>源代码编译GIT之前，确保系统安装了所需的包或者通过以下命令来安装它<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[xiaolu@lucia tmp]$ sudo yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel perl-ExtUtils-MakeMaker package -y</div><div class="line">[xiaolu@lucia tmp]$ sudo yum -y install gcc  (下载 编译器 )</div></pre></td></tr></table></figure></p>
<h2 id="Step-2：下载并编译GIT源代码-‍‍"><a href="#Step-2：下载并编译GIT源代码-‍‍" class="headerlink" title="Step 2：下载并编译GIT源代码 ‍‍"></a>Step 2：下载并编译GIT源代码 ‍‍</h2><p>从 git-scm 下载最新Git源代码或者简单的使用以下载命令下载Git 2.8.2<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[xiaolu@lucia tmp]$ sudo wget -c https://www.kernel.org/pub/software/scm/git/git-2.8.2.tar.gz</div><div class="line">[xiaolu@lucia tmp]$ tar -zxvf git-2.8.2.tar.gz </div><div class="line">[xiaolu@lucia tmp]$ cd git-2.8.2</div><div class="line">[xiaolu@lucia git-2.8.2]$ make prefix=/usr/local/git all</div><div class="line">[xiaolu@lucia git-2.8.2]$ sudo make prefix=/usr/local/git install</div><div class="line">[xiaolu@lucia git-2.8.2]$ su root</div><div class="line">[root@lucia git-2.8.2]# echo &quot;export PATH=$PATH:/usr/local/git/bin&quot; &gt;&gt; /etc/bashrc   # 设置环境变量</div><div class="line">[root@lucia git-2.8.2]# source /etc/bashrc</div></pre></td></tr></table></figure></p>
<h2 id="Step-3：核实GIT-版本"><a href="#Step-3：核实GIT-版本" class="headerlink" title="Step 3：核实GIT 版本"></a>Step 3：核实GIT 版本</h2><p>完成以上步骤后，使用以下命令检查GIT版本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[xiaolu@lucia git-2.8.2]$ git --version</div><div class="line">git version 2.8.2</div></pre></td></tr></table></figure></p>
<h2 id="Step-4：命令补全"><a href="#Step-4：命令补全" class="headerlink" title="Step 4：命令补全"></a>Step 4：命令补全</h2><p>Linux的shell环境通过bash-completion软件包提供命令补齐功能，在录入命令参数时按一次或两次TAB键可实现参数的自动补齐或提示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">[xiaolu@lucia git-2.8.2]$ sudo cp contrib/completion/git-completion.bash /etc/bash_completion.d/   </div><div class="line">                          #将Git源码包中的命令补全脚本肤质到bash-completion对应的目录中</div><div class="line">                          </div><div class="line">[xiaolu@lucia git-2.8.2]$ . /etc/bash_completion.d/git-completion.bash</div><div class="line">                          #重新加载自动补齐脚本，使之在当前的shell中生效</div><div class="line">```            </div><div class="line">为了能够在终端开启时自动加载脚本，需要修改/etc/profile文件和~/.bashrc文件</div><div class="line">```shell</div><div class="line">[root@lucia git-2.8.2]# sudo cat &gt;&gt; ~/.bashrc  &lt;&lt;EOF</div><div class="line">&gt; if [ -f /etc/bash_completion.d/git-completion.bash ]; then</div><div class="line">&gt; . /etc/bash_completion.d/git-completion.bash</div><div class="line">&gt; fi</div><div class="line">&gt; EOF</div><div class="line">[xiaolu@lucia git-2.8.2]$ su root</div><div class="line">[root@lucia git-2.8.2]# sudo cat &gt;&gt; /etc/profile &lt;&lt;EOF</div><div class="line">&gt; if [ -f /etc/bash_completion.d/git-completion.bash ]; then</div><div class="line">&gt; . /etc/bash_completion.d/git-completion.bash</div><div class="line">&gt; fi</div><div class="line">&gt; EOF</div></pre></td></tr></table></figure></p>
<h1 id="附1：中文支持"><a href="#附1：中文支持" class="headerlink" title="附1：中文支持"></a>附1：中文支持</h1><blockquote>
<ul>
<li><p>相关说明：<br>GIT可以在提交说明中使用中文，但是需要对Git进行配置但对于用中文来命名文件、目录和引用，前提是使用UTF-8 字符集的环境下‍</p>
</li>
<li><p>UTF8字符集：<br>1、在提交时，可以在提交说明中输入中文<br>2、显示提交历史，能够正常显示提交说明中的中文字符<br>3、可以添加名称为中文的文件，并可以在同样使用UTF-8字符集的Linux环境中克隆和检出<br>4、可以创建带有中文字符的里程碑名称</p>
</li>
</ul>
</blockquote>
<p>  ❀ 在默认设置下，中文文件名在工作区状态输出、查看历史更改概要，以及在补丁文件中，文件名中的中文不能正确的显示，而是显示为八进制的字符编码，如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[xiaolu@lucia rs-project]$ git status -s</div><div class="line">?? &quot;\346\265\213\350\257\225.txt&quot;</div><div class="line">[xiaolu@lucia rs-project]$ printf &quot;\346\265\213\350\257\225.txt\n&quot;</div><div class="line">测试.txt</div></pre></td></tr></table></figure>
<p> ❀  解决方法：通过将Git配置变量 core.quotepath 设置为 false</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[xiaolu@lucia rs-project]$ git config --global core.quotepath false[xiaolu@lucia rs-project]$ </div><div class="line">[xiaolu@lucia rs-project]$ git status -s</div><div class="line">?? 测试.txt</div></pre></td></tr></table></figure>
<h1 id="附2：相关问题"><a href="#附2：相关问题" class="headerlink" title="附2：相关问题"></a>附2：相关问题</h1><p>make prefix=/usr/local/git all 报错<br>目前我碰到的报错有两种：</p>
<blockquote>
<ul>
<li><p>时间没有校准（看见 in the future 就是时间没有校准，校准后重新make）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">ake[1]: Warning: File `Makefile&apos; has modification time 2.5e+06 s in the future</div><div class="line">/usr/bin/perl Makefile.PL PREFIX=&apos;/usr/local&apos; INSTALL_BASE=&apos;&apos; --localedir=&apos;/usr/local/share/locale&apos;</div><div class="line">Writing perl.mak for Git</div><div class="line">make[1]: warning:  Clock skew detected.  Your build may be incomplete.</div><div class="line">    GEN git-add--interactive</div><div class="line">make[1]: Warning: File `Makefile&apos; has modification time 2.5e+06 s in the future</div><div class="line">Writing perl.mak for Git</div><div class="line">make[2]: Warning: File `Makefile.PL&apos; has modification time 2.5e+06 s in the future</div><div class="line">Writing perl.mak for Git</div><div class="line">make[2]: *** [perl.mak] Error 1</div><div class="line">make[1]: *** [instlibdir] Error 2</div><div class="line">make: *** [git-add--interactive] Error 2</div></pre></td></tr></table></figure>
</li>
<li><ol>
<li>第二种报依赖包错误，导致make失败<br>本文OS是纯净版，实际上真正OS环境下许多依赖包已经安装，且通过yum仓库安装的版本都较老，换yum源后将提示的相关依赖包卸载（rpm -e），然后重新yum安装一下</li>
</ol>
</li>
</ul>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;环境说明：&quot;&gt;&lt;a href=&quot;#环境说明：&quot; class=&quot;headerlink&quot; title=&quot;环境说明：&quot;&gt;&lt;/a&gt;环境说明：&lt;/h1&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;OS：CentOS-6.5.mininal  (NU
    
    </summary>
    
    
      <category term="Git" scheme="http://yoursite.com/tags/Git/"/>
    
  </entry>
  
  <entry>
    <title>高性能集群软件-Keepalived</title>
    <link href="http://yoursite.com/2016/06/13/Keepalived/"/>
    <id>http://yoursite.com/2016/06/13/Keepalived/</id>
    <published>2016-06-13T15:07:33.000Z</published>
    <updated>2016-11-23T14:46:35.498Z</updated>
    
    <content type="html"><![CDATA[<h2 id="keepalived-介绍"><a href="#keepalived-介绍" class="headerlink" title="keepalived 介绍"></a>keepalived 介绍</h2><ul>
<li>keepalived 是 Linux下一个轻量级的高可用解决方案</li>
<li><p>keepalived 主要通过虚拟路由冗余（VRRP）来实现高可用功能</p>
<p><em>优点</em></p>
<ul>
<li>部署及使用简单，只需一个配置文件即可完成</li>
</ul>
<p><em>功能</em></p>
<ul>
<li>服务器状态检测和故障隔离功能        </li>
<li>HA（High Available） cluster &nbsp;  [高可用群集]</li>
</ul>
</li>
</ul>
<hr>
<h2 id="keepalived-发展"><a href="#keepalived-发展" class="headerlink" title="keepalived 发展"></a>keepalived 发展</h2><ul>
<li>keepalived起初是为LVS（Linux Virtual System）设计，专门监控集群系统中各个服务节点的状态<br>根据TCP/IP参考模型 第三、第四、第五层交换机制检测每个服务节点的状态（详细见本页<strong>keepalived工作原理</strong>）</li>
</ul>
<ul>
<li><p><em>e.g: keepalived检测WEB服务器的状态</em><br>如果一台WEB服务器死机/工作出现故障，keepalived检测到此状况后会将故障服务器从系统中剔除；直至该服务器工作正常后keepalived自动将该服务器加入到服务器群中；</p>
<ul>
<li><p>以上工作keepalived自动完成，无需人工干涉，人工干预仅是修复出现故障的服务节点；<br><br></p>
</li>
<li><p>keepalived 后续加入了VRRP功能<br>VRRP（Virtaul Router Redunadancy Protocol，虚拟路由器冗余协议）</p>
</li>
<li>目的：解决静态路由出现的单点故障问题，实现网络不间断稳定运行</li>
</ul>
</li>
</ul>
<h3 id="VRRP-协议与工作原理"><a href="#VRRP-协议与工作原理" class="headerlink" title="VRRP 协议与工作原理"></a>VRRP 协议与工作原理</h3><h4 id="❉-引入VRRP概念"><a href="#❉-引入VRRP概念" class="headerlink" title="❉   引入VRRP概念"></a>❉   引入VRRP概念</h4><p>  <img src="/uploads/keepalived/vrrp.png" alt="vrrp-logo"><br>     <em>说明</em>：图片来源百度百科；左侧图片为局域网组网；右侧图片为VRRP组网</p>
<blockquote>
<ul>
<li><strong>局域网组网 e.g :</strong><ul>
<li>网络内的所有主机会设置一条默认网关（10.100.10.1），当主机发出的目的地址不在本网段（10.100.10.0/24）的报文；通过默认网关发往路由器A，从而实现主机与外部网络的通信</li>
<li>该组网缺点：当路由器A坏掉时，本网段内通过以RA为默认网关下一跳的主机将断掉与外界的通信，产生单点故障</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><p><strong>VRRP组网 e.g :</strong></p>
<blockquote>
<p>RA：Master 活动路由器  —&gt;10.100.10.2<br>RB：Backup 备份路由器  —&gt;10.100.10.3<br>VRIP : 虚拟路由器IP   —-&gt;10.100.10.1</p>
</blockquote>
<ul>
<li><p>VRRP将局域网中的一组路由器【 RA和RB】组成一个虚拟路由器——&gt;&gt;&gt;备份组</p>
<blockquote>
<p>   虚拟路由器拥有自己的IP地址 10.100.10.1<br>局域网内的主机仅知道虚拟路由器IP地址为10.100.10.1，不知道具体的Master与Backup路由器IP<br>局域网内的主机将默认网关下一跳的地址设置为该虚拟路由器IP地址，通过该地址与其他网络进行通信</p>
</blockquote>
</li>
<li><p>该组网优点：当备份组内的Master路由器DOWN掉，会进行选举策略选出一个新的Master路由器，继续往网络内的主机提供路由服务，从而实现网络内的主机不间断地与外部网络进行通信</p>
</li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="❉-VRRP-协议"><a href="#❉-VRRP-协议" class="headerlink" title="❉    VRRP 协议"></a>❉    VRRP 协议</h4><blockquote>
<ul>
<li>VRRP：解决局域网中配置静态网关出现单点失效的路由协议</li>
<li>设计目标：网络发生故障时透明地进行设备切换而不影响主机间的数据通信</li>
</ul>
</blockquote>
<h4 id="❉-VRRP-工作原理"><a href="#❉-VRRP-工作原理" class="headerlink" title="❉    VRRP 工作原理"></a>❉    VRRP 工作原理</h4><blockquote>
<p> VRRP协议将两台或多台路由器设备虚拟成一个虚拟路由器，对外提供虚拟路由器IP(一个或多个)；<br>   而在路由器组内部，如果实际拥有这个对外IP的路由器如果工作正常的话就是MASTER，或者是通过算法选举产生；MASTER实现针对虚拟路由器IP的各种网络功能，如ARP请求，ICMP，以及数据的转发等；<br>   其他设备不拥有该IP，状态是BACKUP，除了接收MASTER的VRRP状态通告信息外，不执行对外的网络功能。<br>   当主机失效时，BACKUP将接管原先MASTER的网络功能。</p>
<hr>
<ul>
<li><strong>❀  如何判定多个路由器在同一组虚拟路由器中？</strong><ul>
<li>VRID：每个虚拟路由器都有一个唯一标识（VRID是一个0～255的正整数）;<br>配置VRRP协议时需要配置每个路由器的虚拟路由器ID(VRID)和优先权值;<br>使用VRID将路由器进行分组，具有相同VRID值的路由器为同一个组</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><strong>❀  BACKUP 为什么没有发生抢占？</strong><ul>
<li>VRRP通告:它使用IP多播数据包进行封装，组地址为224.0.0.18，发布范围只限于同一局域网内;<br>在一个虚拟路由器中，只有处于MASTER角色的路由器会一直发送VRRP通告信息；<br>处于BACKUP状态的路由器只接收MASTER发过来的报文信息，用来监控MASTER运行状态; 除非它的优先级比MASTER更高</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><strong>❀  什么时候发生选举？</strong><ul>
<li>当MASTER不可用时，BACKUP无法收到MASTER发过来的报文信息；<br>认定MASTER出现故障，然后多台BACKUP就开始进行选举；</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><strong>❀  Master选举</strong><ul>
<li>虚拟路由器IP=路由器本身配置IP<br>该路由器始终将是MASTER；IP地址所有者自动具有最高优先级：255</li>
<li>优先级选举主控路由器（优先级范围是0—255）<br>优先级0一般用在IP地址所有者主动放弃主控者角色时使用。可配置的优先级范围为1—254</li>
<li>优先级相等，则比较路由器的实际IP，IP值较大的优先权高</li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="❉-VRRP-应用实例"><a href="#❉-VRRP-应用实例" class="headerlink" title="❉    VRRP 应用实例"></a>❉    VRRP 应用实例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">            +-----------+      +-----------+</div><div class="line">            |   Rtr1    |      |   Rtr2    |</div><div class="line">            |(MR VRID=1)|      |(BR VRID=1)|</div><div class="line">            |(BR VRID=2)|      |(MR VRID=2)|</div><div class="line">    VRID=1  +-----------+      +-----------+  VRID=2</div><div class="line">    IP A ----------&gt;*            *&lt;---------- IP B</div><div class="line">                    |            |</div><div class="line">                    |            |</div><div class="line">  ------------------+------------+-----+--------+--------+--------+--</div><div class="line">                                       ^        ^        ^        ^</div><div class="line">                                       |        |        |        |</div><div class="line">                                     (IP A)   (IP A)   (IP B)   (IP B)</div><div class="line">                                       |        |        |        |</div><div class="line">                                    +--+--+  +--+--+  +--+--+  +--+--+</div><div class="line">                                    |  H1 |  |  H2 |  |  H3 |  |  H4 |</div><div class="line">                                    +-----+  +-----+  +--+--+  +--+--+</div><div class="line">     Legend:</div><div class="line">              ---+---+---+--  =  Ethernet, Token Ring, or FDDI</div><div class="line">                           H  =  Host computer</div><div class="line">                          MR  =  Master Router</div><div class="line">                          BR  =  Backup Router</div><div class="line">                           *  =  IP Address</div><div class="line">                        (IP)  =  default router for hosts</div><div class="line"></div><div class="line"></div><div class="line">-----------------------------------------------------------------</div><div class="line"></div><div class="line">    +   VRID 1       |   Rtr1（Master）     |    Rtr2（Backup） +  正常情况下  H1与H2走R1;反之 走R2</div><div class="line"></div><div class="line">    +   VRID 2       |   Rtr1（Backup）    |    Rtr2 （Master） +  正常情况下  H3与H4走R2;反之 走R1</div></pre></td></tr></table></figure>
<h2 id="keepalived-安装"><a href="#keepalived-安装" class="headerlink" title="keepalived  安装"></a>keepalived  安装</h2><blockquote>
<ul>
<li>实验需求：<br><em>安装keepalived（仅安装）</em></li>
<li>实验实现：<br><em>服务器：CentOS 6.5-minimal</em><br><em>软    件：Keepalived ( V_1.2.19 )</em>    </li>
</ul>
</blockquote>
<hr>
<blockquote>
<ul>
<li>安装过程：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"># 下载安装包并解压，查看相关参数</div><div class="line"></div><div class="line">[root@lucia tmp]# wget http://www.keepalived.org/software/keepalived-1.2.19.tar.gz    # 下载Keepalived安装包</div><div class="line">[root@lucia tmp]# tar -zxf keepalived-1.2.19.tar.gz   #解压安装包</div><div class="line">[root@lucia tmp]# cd keepalived-1.2.19</div><div class="line">[root@lucia keepalived-1.2.19]# ./configure --help    #查看confiure编译参数</div><div class="line"> </div><div class="line">#================================================</div><div class="line"># 指定安装在/etc/ &#123;--sysconfdir=/etc&#125;</div><div class="line"># 指定使用内核源码中的头文件 &#123;--with-kernel-dir&#125;</div><div class="line"># 注：使用LVS时，需要用到&quot;--with-kernel-dir&quot;</div><div class="line">#===============================================</div></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>
<hr>
<blockquote>
<ul>
<li>编译安装<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line">[root@lucia keepalived-1.2.19]# [ -z /usr/src/kernels/ ] &amp;&amp; yum -y install kernel-headers kernel-devel || echo &quot;The kernel file already exists&quot;</div><div class="line">The kernel file already exists</div><div class="line"></div><div class="line"></div><div class="line">#===========================</div><div class="line"># 判断kernels目录是否存在文件</div><div class="line">#===========================</div><div class="line"> </div><div class="line">[root@lucia keepalived-1.2.19]# ./configure --sysconfdir=/etc/ --with-kernel-dir=/usr/src/kernels/2.6.32-573.12.1.el6.x86_64</div><div class="line"> </div><div class="line">#============================================================================</div><div class="line"># ./configure 对即将安装的软件进行配置，检查当前的环境是否满足要安装软件的依赖关系</div><div class="line">#============================================================================</div><div class="line"></div><div class="line">configure: error: in `/tmp/keepalived-1.2.19&apos;:</div><div class="line">configure: error: no acceptable C compiler found in $PATH</div><div class="line">See `config.log&apos; for more details</div><div class="line"> </div><div class="line">#============================================================================</div><div class="line"># 报错：gcc编译器没有安装</div><div class="line"># [root@lucia keepalived-1.2.19]# yum -y install gcc</div><div class="line">#=============================================================================</div><div class="line">      </div><div class="line">继续返回上一步预安装./configure</div><div class="line">[root@lucia keepalived-1.2.19]# ./configure --sysconfdir=/etc/ --with-kernel-dir=/usr/src/kernels/2.6.32-573.12.1.el6.x86_64</div><div class="line"> </div><div class="line">configure: error:</div><div class="line">!!! OpenSSL is not properly installed on your system. !!!</div><div class="line">!!! Can not include OpenSSL headers files.            !!!</div><div class="line"> </div><div class="line">#=========================================================================</div><div class="line"># 报错：OpenSSL 没有安装</div><div class="line"># [root@lucia keepalived-1.2.19]# yum -y install openssl*</div><div class="line">#=========================================================================</div><div class="line"></div><div class="line">./configure 成功后，显示是Keepalived 输出的加载模块信息</div><div class="line"></div><div class="line">Keepalived configuration</div><div class="line">------------------------</div><div class="line">Keepalived version       : 1.2.19                         </div><div class="line">Compiler                 : gcc</div><div class="line">Compiler flags           : -g -O2</div><div class="line">Extra Lib                : -lssl -lcrypto -lcrypt </div><div class="line">Use IPVS Framework       : Yes</div><div class="line">IPVS sync daemon support : Yes</div><div class="line">IPVS use libnl           : No</div><div class="line">fwmark socket support    : Yes</div><div class="line">Use VRRP Framework       : Yes</div><div class="line">Use VRRP VMAC            : Yes</div><div class="line">SNMP support             : No</div><div class="line">SHA1 support             : No</div><div class="line">Use Debug flags          : No</div><div class="line"></div><div class="line">[root@lucia keepalived-1.2.19]# make &amp;&amp; make install                     #编译&amp;&amp;安装</div><div class="line">[root@lucia keepalived-1.2.19]# ln -s /usr/local/sbin/keepalived /sbin/  #软链接到系统使用的管理程序目录中</div><div class="line">[root@lucia keepalived-1.2.19]# chkconfig --add keepalived               #添加到系统服务</div><div class="line">[root@lucia keepalived-1.2.19]# chkconfig --level 35 keepalived on       #添加到开机启动</div></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>
<hr>
<h3 id="❉-Keepalived-配置详解"><a href="#❉-Keepalived-配置详解" class="headerlink" title="❉   Keepalived 配置详解"></a>❉   Keepalived 配置详解</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div></pre></td><td class="code"><pre><div class="line">[root@lucia keepalived-1.2.19]# cd /etc/keepalived/</div><div class="line">[root@lucia keepalived-1.2.19]# ls</div><div class="line">keepalived.conf  samples</div><div class="line"></div><div class="line"># ================================================================</div><div class="line"># Keepalived 配置文件路径为/etc/keepalived/keepalived.conf</div><div class="line"># samples 目录下存放着keepalived配置的示例</div><div class="line"># ================================================================</div><div class="line">#============================================================</div><div class="line"># keepalived.conf 配置</div><div class="line">#------------------------------------------------------------</div><div class="line"># 1、Keepalived 配置文件以block形式组织，每个块内容都包含在&#123;&#125;</div><div class="line"># 2、“#”   “!” 开头行为注释</div><div class="line"># 3、keepalived 配置为三类：</div><div class="line">#      全局配置:对整个keepalived都生效的配置 </div><div class="line">#    VRRPD 配置:核心配置，主要实现keepalived高可用功能</div><div class="line">#      LVS配置</div><div class="line">#============================================================</div><div class="line"></div><div class="line"></div><div class="line">! Configuration File for keepalived   </div><div class="line"></div><div class="line">    </div><div class="line">########################</div><div class="line">#  全局配置</div><div class="line">########################</div><div class="line"></div><div class="line"> </div><div class="line">global_defs &#123;                               # global_defs 全局配置标识 </div><div class="line">                                            ------------------------------------------</div><div class="line">   notification_email &#123;                     # notification_email用于设置报警邮件地址</div><div class="line">     acassen@firewall.loc                   # 可以设置多个，每行一个</div><div class="line">     failover@firewall.loc                  # 设置邮件报警，需开启本机Sendmail 服务</div><div class="line">     sysadmin@firewall.loc                  # yum -y install mailx sendmail</div><div class="line">   &#125;                                        ----------------------------------------------</div><div class="line"></div><div class="line">   notification_email_from Alexandre.Cassen@firewall.loc  # 设置邮件发送地址</div><div class="line">   smtp_server 192.168.200.1                              # 设置邮件的smtp server地址</div><div class="line">   smtp_connect_timeout 30                                # 设置连接smtp sever超时时间</div><div class="line">   router_id LVS_DEVEL                                    # 表示运行keepalived服务器标识，发邮件时显示在邮件主题中的信息</div><div class="line">&#125;</div><div class="line"></div><div class="line">######################</div><div class="line">#  VRRPD配置</div><div class="line">######################</div><div class="line"></div><div class="line">vrrp_instance VI_1 &#123;         # VRRPD 配置标识 VI_1是实例名称</div><div class="line"></div><div class="line">    state MASTER             # 指定Keepalvied角色 MASTER表示此主机为主服务器 BACKUP则是表示为备用服务器</div><div class="line">    interface eth0           # 指定 HA 监测网络的接口</div><div class="line">    virtual_router_id 51     # 虚拟路由标识，标识为数字，同一个VRRP实例使用唯一的标识，即可表示在同一个vrrp_instance下 MASTER_ID = BACKUP_ID</div><div class="line">    priority 100             # 定义节点优先级，数字越大表示节点的优先级越高，同一个VRRP_instance下，MASTE_PRIORITY &gt; BACKUP_PRIORITY </div><div class="line">    advert_int 1             # 设定MASTER与BACKUP主机质检同步检查的时间间隔，单位为秒</div><div class="line">             </div><div class="line">    authentication &#123;         # 设定节点间通信验证类型和密码，验证类型主要有PASS和AH两种</div><div class="line">        auth_type PASS       # 同一个vrrp_instance，MASTER验证密码和BACKUP保持一致</div><div class="line">        auth_pass 1111</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    virtual_ipaddress &#123;      # 设置虚拟IP地址 (VIP),又叫做漂移IP地址</div><div class="line">        192.168.200.16</div><div class="line">        192.168.200.17</div><div class="line">        192.168.200.18</div><div class="line">    &#125;</div><div class="line"></div><div class="line">#-------------------------------------------------------------------------------</div><div class="line"># 问：为什么叫漂移IP地址？</div><div class="line"># 答：当Keepalived切换到MASTER状态时，IP地址会自动添加到系统中</div><div class="line">#    当Keepalvied切换到BACKUP状态时，IP地址将自动从系统中删除</div><div class="line">#    </div><div class="line">#    keepalived通过“ip address add”命令的形式将VIP添加到系统</div><div class="line">#    通过“ip add”查看系统中添加的VIP地址</div><div class="line">#--------------------------------------------------------------------------------</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">######################</div><div class="line"># LVS配置</div><div class="line">######################</div><div class="line"></div><div class="line"></div><div class="line">virtual_server 192.168.200.100 443 &#123;              # virtual_server LVS配置标识 </div><div class="line">                                                  # 格式：virtual_server VIP port [IP 和 port 之间空格隔开]</div><div class="line"> </div><div class="line">    delay_loop 6                                  # 设置健康检查时间间隔，单位为秒                      </div><div class="line">    lb_algo rr                                    # 设置负载调度算法，可用的调度算法有：rr、wlc、lc、lblc、sh、dh等</div><div class="line">    lb_kind NAT                                   # 设置LVS实现负载均衡的机制，有NAT、TUN和DR三种模式可选</div><div class="line">    nat_mask 255.255.255.0                        # NAT子网掩码</div><div class="line">    persistence_timeout 50                        # 会话保持时间 </div><div class="line">    protocol TCP                                  # 指定转发协议类型</div><div class="line">#----------------------------------------------------------------------------------------------------</div><div class="line"># persistence_timeout 会话保持时间对动态网页非常有用，为集群系统中的seesion共享提供了一个很好的解决方案</div><div class="line"># 用户的请求会一直分发到某个服务节点，直至超过这个会话的保持时间（指最大无响应超时时间）</div><div class="line"># =[用户操作动态页面如果在50s没有执行任何操作则被分发到另外的节点]</div><div class="line">#----------------------------------------------------------------------------------------------------</div><div class="line"></div><div class="line">    real_server 192.168.201.100 443 &#123;                          # 设置real server段开始的标识 [ IP为真实IP地址]</div><div class="line">                                                               # 格式：real_server realIP port [IP 和 port 之间空格隔开]</div><div class="line">                                                               -----------------------------------------------------------------</div><div class="line">        weight 1                                               # 用于配置real server节点的权值，权值大小用数字表示，数字越大，权值越高</div><div class="line">                                                               # 设置权值大小可以为不同性能的服务器分配不同的负载</div><div class="line">                                                               ------------------------------------------------------------------</div><div class="line"></div><div class="line">        SSL_GET &#123;                                              # 健康检查 SSL_GET    </div><div class="line">            url &#123;                                              # 指定SSL检查的URL信息，可以指定多个</div><div class="line">              path /index.html                                 # 后跟详细的URL路径</div><div class="line">              digest ff20ad2481f97b1754ef3e12ecd3a9cc          # SSL检查后的摘要信息，可以通过genhash命令工具获取</div><div class="line">#-----------------------------------------------------------------</div><div class="line"># [root@lucia keepalived]# genhash -s 192.168.201.100 -p 80 -u /index.html</div><div class="line">#-----------------------------------------------------------------</div><div class="line">            &#125;</div><div class="line">            url &#123;</div><div class="line">              path /mrtg/</div><div class="line">              digest 9b3a0c85a887a256d6939da88aabd8cd</div><div class="line">            &#125;</div><div class="line">            connect_timeout 3                                  # 表示无响应超时时间，单位为秒</div><div class="line">            nb_get_retry 3                                     # 表示重试次数</div><div class="line">            delay_before_retry 3                               # 表示充实间隔</div><div class="line">        &#125; </div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"> </div><div class="line">virtual_server 10.10.10.2 1358 &#123;</div><div class="line">    delay_loop 6</div><div class="line">    lb_algo rr </div><div class="line">    lb_kind NAT</div><div class="line">    persistence_timeout 50</div><div class="line">    protocol TCP</div><div class="line"> </div><div class="line">    sorry_server 192.168.200.200 1358                          # 备份节点，在所有real serer失效后，启用备份节点</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<blockquote>
<ul>
<li>VRRP原理参考文档如下：<ul>
<li><a href="http://bbs.nanjimao.com/thread-790-1-1.html" target="_blank" rel="external">http://bbs.nanjimao.com/thread-790-1-1.html</a> （此篇写的很好）</li>
<li><a href="http://blog.chinaunix.net/uid-26575352-id-3529109.html" target="_blank" rel="external">http://blog.chinaunix.net/uid-26575352-id-3529109.html</a></li>
<li>keepalived.conf 参考书籍 《高性能Linux服务器构建实战》</li>
</ul>
</li>
</ul>
</blockquote>
<hr>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;keepalived-介绍&quot;&gt;&lt;a href=&quot;#keepalived-介绍&quot; class=&quot;headerlink&quot; title=&quot;keepalived 介绍&quot;&gt;&lt;/a&gt;keepalived 介绍&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;keepalived 是 Linux下一
    
    </summary>
    
    
      <category term="keepalived" scheme="http://yoursite.com/tags/keepalived/"/>
    
  </entry>
  
</feed>
